<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Gamble to Win! - Slots</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(to right, #0f2027, #203a43, #2c5364);
      color: white;
      text-align: center;
      padding: 20px;
    }
    h1 {
      font-size: 3rem;
      margin-bottom: 5px;
    }
    .game {
      margin: 20px auto;
      padding: 20px;
      background: rgba(0, 0, 0, 0.6);
      border-radius: 15px;
      max-width: 600px;
    }
    button, input[type="number"] {
      padding: 10px 20px;
      margin: 10px 5px;
      font-size: 1rem;
      border: none;
      border-radius: 10px;
      cursor: pointer;
    }
    button:disabled {
      background-color: #999;
      cursor: wait;
    }
    button {
      background-color: #e67e22;
      color: white;
    }
    button:hover:enabled {
      background-color: #d35400;
    }
    .slot {
      display: inline-block;
      background: white;
      color: black;
      padding: 10px;
      margin: 5px;
      border-radius: 5px;
      font-size: 2rem;
      width: 100px;
      height: 80px;
      line-height: 80px;
      font-weight: bold;
      animation: pop 0.2s ease-out;
    }
    @keyframes pop {
      0% { transform: scale(1); }
      50% { transform: scale(1.3); }
      100% { transform: scale(1); }
    }
    #result {
      margin-top: 20px;
      font-size: 1.3rem;
      white-space: pre-wrap;
      min-height: 2em;
    }
    a {
      display: inline-block;
      margin-top: 10px;
      color: #e67e22;
      text-decoration: none;
      font-weight: bold;
    }
    a:hover {
      color: #d35400;
    }
  </style>
</head>
<body>
  <h1>üé∞ Gamble to Win! - Slots</h1>
  <div class="game">
    <p id="money">Current Money: $0</p>
    <label>Enter Your Bet:</label>
    <input type="number" id="betAmount" min="1" value="100" />
    <br/>
    <button id="spinBtn" onclick="pullLever()">üéØ Pull Lever</button>
    <div id="slotsArea">
      <div class="slot" id="slot1">‚ùì</div>
      <div class="slot" id="slot2">‚ùì</div>
      <div class="slot" id="slot3">‚ùì</div>
    </div>
    <div id="result"></div>
    <a href="index.html">‚¨Ö Back to Home</a>
  </div>

  <script>
    const spinBtn = document.getElementById('spinBtn');
    const resultEl = document.getElementById('result');
    const moneyEl = document.getElementById('money');
    const slots = [
      document.getElementById('slot1'),
      document.getElementById('slot2'),
      document.getElementById('slot3'),
    ];

    let money = localStorage.getItem('money') ? parseInt(localStorage.getItem('money')) : 1000;

    const symbolTable = [
      { name: 'duck', chance: 39, emoji: 'ü¶Ü' },
      { name: 'chocolate', chance: 25, emoji: 'üç´' },
      { name: 'bat', chance: 14, emoji: 'üèè' },
      { name: 'pistol', chance: 9, emoji: 'üî´' },
      { name: 'smg', chance: 5, emoji: 'üí•' },
      { name: 'car', chance: 3, emoji: 'üöó' },
      { name: 'atomic', chance: 1.95, emoji: '‚ò¢Ô∏è' },
      { name: '7', chance: 1.16, emoji: '7Ô∏è‚É£' }
    ];

    function updateMoney() {
      moneyEl.innerText = `Current Money: $${money}`;
      localStorage.setItem('money', money);
    }

    function getBet() {
      const bet = parseInt(document.getElementById('betAmount').value);
      if (isNaN(bet) || bet <= 0) {
        resultEl.innerText = '‚ùó Enter a valid bet.';
        return null;
      }
      if (bet > money) {
        resultEl.innerText = '‚ùå Not enough money!';
        return null;
      }
      return bet;
    }

    function pickSymbol() {
      let r = Math.random() * 100;
      let sum = 0;
      for (let sym of symbolTable) {
        sum += sym.chance;
        if (r < sum) return sym;
      }
      return symbolTable[0];
    }

    function getResultMultiplier(names) {
      const count = name => names.filter(n => n === name).length;

      const combos = [
        { match: n => ['duck','chocolate','bat'].every(x => n.includes(x)), mult: 2, name: 'Pinata' },
        { match: n => count('duck') === 3, mult: 3, name: 'Flock O Ducks' },
        { match: n => count('duck') === 2 && count('pistol') === 1, mult: 3, name: 'Duck Hunting' },
        { match: n => count('duck') === 2 && count('smg') === 1, mult: 4, name: 'Serious Duck Hunting' },
        { match: n => count('chocolate') === 3, mult: 4, name: 'Sweet Tooth' },
        { match: n => count('duck') === 2 && count('car') === 1, mult: 6, name: 'Road Kill' },
        { match: n => count('chocolate') === 2 && count('atomic') === 1, mult: 7, name: 'Meltdown 1' },
        { match: n => count('atomic') === 2 && count('chocolate') === 1, mult: 7, name: 'Meltdown 2' },
        { match: n => count('car') === 2 && count('bat') === 1, mult: 8, name: 'Vandalism' },
        { match: n => count('car') === 1 && count('bat') === 2, mult: 8, name: 'Vandalism 2' },
        { match: n => count('bat') === 3, mult: 8, name: 'Homerun' },
        { match: n => count('smg') === 2 && count('pistol') === 1, mult: 10, name: 'Gunfight' },
        { match: n => count('smg') === 1 && count('pistol') === 2, mult: 10, name: 'Gunfight 2' },
        { match: n => count('car') === 1 && (count('pistol') === 2 || count('smg') === 2), mult: 20, name: 'Driveby' },
        { match: n => count('pistol') === 3, mult: 40, name: 'Firing Range' },
        { match: n => count('smg') === 3, mult: 200, name: 'Overkill' },
        { match: n => count('car') === 3, mult: 1000, name: 'Pileup' },
        { match: n => count('atomic') === 3, mult: 2000, name: 'Radioactive' },
        { match: n => count('7') === 3, mult: 10000, name: 'JACKPOT' }
      ];

      for (let combo of combos) {
        if (combo.match(names)) return combo;
      }

      return { mult: 0, name: null };
    }

    async function pullLever() {
      const bet = getBet();
      if (!bet) return;

      money -= bet;
      updateMoney();
      resultEl.innerText = 'Spinning...';
      spinBtn.disabled = true;

      const spinResult = [];

      for (let i = 0; i < 3; i++) {
        await new Promise(resolve => setTimeout(resolve, 400));
        const sym = pickSymbol();
        slots[i].textContent = sym.emoji;
        slots[i].style.animation = 'none';
        void slots[i].offsetWidth; // trigger reflow
        slots[i].style.animation = 'pop 0.2s ease-out';
        spinResult.push(sym.name);
      }

      const result = getResultMultiplier(spinResult);

      if (result.mult > 0) {
        const win = bet * result.mult;
        money += win;
        resultEl.innerText = `üéâ ${result.name}! You win $${win}`;
      } else {
        resultEl.innerText = `üíÄ You lost $${bet}`;
      }

      updateMoney();
      spinBtn.disabled = false;
    }

    updateMoney();
  </script>
</body>
</html>
