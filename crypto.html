<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Crypto Trading - Gamble to Win!</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: linear-gradient(to right, #0f2027, #203a43, #2c5364);
    color: white;
    text-align: center;
    padding: 20px;
  }
  h1 {
    margin-bottom: 20px;
  }
  table {
    margin: 0 auto 30px;
    border-collapse: collapse;
    width: 360px;
  }
  th, td {
    padding: 8px;
    border: 1px solid white;
  }
  input[type=number] {
    width: 70px;
    padding: 6px;
    border-radius: 6px;
    border: none;
    text-align: center;
    font-size: 1rem;
  }
  button {
    padding: 6px 12px;
    border: none;
    border-radius: 8px;
    background-color: #e67e22;
    color: white;
    font-weight: bold;
    cursor: pointer;
    margin-left: 4px;
    transition: background-color 0.3s ease;
  }
  button:hover {
    background-color: #d35400;
  }
  .green {
    color: #2ecc71;
    font-weight: bold;
  }
  .red {
    color: #e74c3c;
    font-weight: bold;
  }
  #output {
    margin-top: 20px;
    min-height: 40px;
  }
  #moneyDisplay {
    font-size: 1.3rem;
    margin-bottom: 20px;
  }
</style>
</head>
<body>
<h1>Crypto Trading</h1>

<div id="moneyDisplay">Money: $0</div>

<table>
  <thead>
    <tr>
      <th>Coin</th>
      <th>Price ($)</th>
      <th>Change</th>
      <th>Buy</th>
      <th>Sell</th>
      <th>Your Coins</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Bitcoin</td>
      <td id="btcPrice">-</td>
      <td id="btcChange">-</td>
      <td><input type="number" id="btcBuyAmount" min="0" step="0.0001" placeholder="Amount" /></td>
      <td><input type="number" id="btcSellAmount" min="0" step="0.0001" placeholder="Amount" /></td>
      <td id="btcOwned">0</td>
      <td><button onclick="buyCoin('btc')">Buy</button></td>
      <td><button onclick="sellCoin('btc')">Sell</button></td>
    </tr>
    <tr>
      <td>Doge</td>
      <td id="dogePrice">-</td>
      <td id="dogeChange">-</td>
      <td><input type="number" id="dogeBuyAmount" min="0" step="0.01" placeholder="Amount" /></td>
      <td><input type="number" id="dogeSellAmount" min="0" step="0.01" placeholder="Amount" /></td>
      <td id="dogeOwned">0</td>
      <td><button onclick="buyCoin('doge')">Buy</button></td>
      <td><button onclick="sellCoin('doge')">Sell</button></td>
    </tr>
    <tr>
      <td>RUG</td>
      <td id="rugPrice">-</td>
      <td id="rugChange">-</td>
      <td><input type="number" id="rugBuyAmount" min="0" step="1" placeholder="Amount" /></td>
      <td><input type="number" id="rugSellAmount" min="0" step="1" placeholder="Amount" /></td>
      <td id="rugOwned">0</td>
      <td><button onclick="buyCoin('rug')">Buy</button></td>
      <td><button onclick="sellCoin('rug')">Sell</button></td>
    </tr>
  </tbody>
</table>

<div id="output"></div>

<script>
  // User money and coins stored in localStorage
  let money = parseFloat(localStorage.getItem('money')) || 10000;

  const coins = {
    btc: { price: 30000, prevPrice: 30000, owned: 0 },
    doge: { price: 0.25, prevPrice: 0.25, owned: 0 },
    rug: { price: 0.001, prevPrice: 0.001, owned: 0 },
  };

  // Load saved owned coins
  for (const c of Object.keys(coins)) {
    coins[c].owned = parseFloat(localStorage.getItem(c + 'Owned')) || 0;
  }

  // Save owned coins and money
  function saveState() {
    localStorage.setItem('money', money.toFixed(2));
    for (const c of Object.keys(coins)) {
      localStorage.setItem(c + 'Owned', coins[c].owned.toFixed(8));
    }
    saveRugPrice();
  }

  // Display money and owned coins
  function updateDisplay() {
    document.getElementById('moneyDisplay').innerText = `Money: $${money.toFixed(2)}`;
    document.getElementById('btcOwned').innerText = coins.btc.owned.toFixed(8);
    document.getElementById('dogeOwned').innerText = coins.doge.owned.toFixed(8);
    document.getElementById('rugOwned').innerText = coins.rug.owned.toFixed(0);
  }

  // Show price and percent change with colors
  function updatePriceDisplay() {
    updateCoinPrice('btc', 'btcPrice', 'btcChange');
    updateCoinPrice('doge', 'dogePrice', 'dogeChange');
    updateCoinPrice('rug', 'rugPrice', 'rugChange');
  }

  function updateCoinPrice(coinKey, priceId, changeId) {
    const coin = coins[coinKey];
    const priceEl = document.getElementById(priceId);
    const changeEl = document.getElementById(changeId);

    priceEl.innerText = coin.price.toFixed(6);

    const changePercent = ((coin.price - coin.prevPrice) / coin.prevPrice) * 100;
    const roundedChange = changePercent.toFixed(2);

    if (changePercent > 0) {
      changeEl.innerHTML = `<span class="green">+${roundedChange}%</span>`;
    } else if (changePercent < 0) {
      changeEl.innerHTML = `<span class="red">${roundedChange}%</span>`;
    } else {
      changeEl.innerText = '0.00%';
    }
  }

  // Random walk for BTC and DOGE price simulation
  function randomWalkPrice(coinKey, maxChangePercent) {
    const coin = coins[coinKey];
    coin.prevPrice = coin.price;
    const changePercent = (Math.random() * 2 - 1) * maxChangePercent;
    coin.price = Math.max(0.0001, coin.price * (1 + changePercent / 100));
  }

  // RUG coin variables
  const RUG_MAX_PRICE = 1000000;
  let rugPumpInterval = null;
  let rugPulled = false;
  let rugBoughtTime = null;

  function saveRugPrice() {
    localStorage.setItem('rugPrice', coins.rug.price);
  }
  function loadRugPrice() {
    const p = parseFloat(localStorage.getItem('rugPrice'));
    if (p && p > 0) {
      coins.rug.price = p;
    } else {
      coins.rug.price = 0.001;
    }
    coins.rug.prevPrice = coins.rug.price;
  }

  function rugPump() {
    if (!rugPulled) {
      coins.rug.prevPrice = coins.rug.price;
      coins.rug.price = Math.min(RUG_MAX_PRICE, coins.rug.price + Math.random() * 0.5);
      saveRugPrice();
    }
  }

  function rugPull() {
    rugPulled = true;
    coins.rug.prevPrice = coins.rug.price;
    coins.rug.price = coins.rug.price * 0.01;
    saveRugPrice();
    rugBoughtTime = null;

    setTimeout(() => {
      rugPulled = false;
    }, 10000);
  }

  function updateRugPrice() {
    if (rugBoughtTime && Date.now() - rugBoughtTime < 30000) {
      rugPump();
    } else {
      if (Math.random() < 0.2) {
        rugPull();
      } else {
        rugPump();
      }
    }
  }

  // Buy/sell coin functions
  function buyCoin(coinKey) {
    const buyInput = document.getElementById(coinKey + 'BuyAmount');
    let amount = parseFloat(buyInput.value);
    if (isNaN(amount) || amount <= 0) {
      showOutput('Enter valid buy amount.');
      return;
    }
    const coin = coins[coinKey];
    const cost = amount * coin.price;
    if (cost > money) {
      showOutput('Not enough money to buy.');
      return;
    }
    money -= cost;
    coin.owned += amount;
    if (coinKey === 'rug') {
      rugBoughtTime = Date.now();
      rugPulled = false;
    }
    saveState();
    updateDisplay();
    showOutput(`Bought ${amount} ${coinKey.toUpperCase()} for $${cost.toFixed(2)}.`);
  }

  function sellCoin(coinKey) {
    const sellInput = document.getElementById(coinKey + 'SellAmount');
    let amount = parseFloat(sellInput.value);
    if (isNaN(amount) || amount <= 0) {
      showOutput('Enter valid sell amount.');
      return;
    }
    const coin = coins[coinKey];
    if (amount > coin.owned) {
      showOutput('Not enough coins to sell.');
      return;
    }
    const gain = amount * coin.price;
    money += gain;
    coin.owned -= amount;
    saveState();
    updateDisplay();
    showOutput(`Sold ${amount} ${coinKey.toUpperCase()} for $${gain.toFixed(2)}.`);
  }

  function showOutput(msg) {
    document.getElementById('output').innerText = msg;
  }

  // Update all prices every 5 seconds
  function updatePrices() {
    coins.btc.prevPrice = coins.btc.price;
    coins.doge.prevPrice = coins.doge.price;

    randomWalkPrice('btc', 1);
    randomWalkPrice('doge', 3);

    updateRugPrice();

    updatePriceDisplay();
  }

  // On load init
  loadRugPrice();
  updateDisplay();
  updatePriceDisplay();

  setInterval(() => {
    updatePrices();
  }, 5000);
</script>
</body>
</html>
